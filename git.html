<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-12-07 Wed 18:49 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Git</title>
<meta name="author" content="Luca Zaninotto" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
<link rel="stylesheet" type="text/css" href="https://gongzhitaao.org/orgcss/org.css"/>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Git</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org3582475">1. Intro</a></li>
<li><a href="#orgda9ca51">2. Modello</a>
<ul>
<li><a href="#orgf2109f1">2.1. Cartelle e file (tree and blob)</a></li>
<li><a href="#orgae4d1b0">2.2. Dare dei nomi</a></li>
<li><a href="#orga31c090">2.3. Dare dei nomi migliori</a></li>
</ul>
</li>
<li><a href="#org7f1613b">3. Demo</a>
<ul>
<li><a href="#org8af8079">3.1. init</a></li>
<li><a href="#org817bac3">3.2. status</a></li>
<li><a href="#org014697e">3.3. aggiungere qualcosa</a></li>
<li><a href="#org8fe4720">3.4. Modificare e fare nuovo commit</a></li>
<li><a href="#org9fd03ff">3.5. Visualizzare la storia</a></li>
<li><a href="#org57c8328">3.6. Nomi di default</a></li>
<li><a href="#org3d4f4a2">3.7. diff</a></li>
<li><a href="#org77ff08e">3.8. Lavorare in parallelo</a></li>
<li><a href="#orgb3075eb">3.9. Remotes</a></li>
</ul>
</li>
<li><a href="#org2be27e4">4. Credits / risorse</a></li>
</ul>
</div>
</div>
<div id="outline-container-org3582475" class="outline-2">
<h2 id="org3582475"><span class="section-number-2">1.</span> Intro</h2>
<div class="outline-text-2" id="text-1">
<p>
<code>Git</code> è un software per la collaborazione e la tracciabilità di
codice sorgente. Molti di voi avranno forse sentito parlare di
Github. Github è una piattaforma che permette di sincronizzare
liberamente delle repository di <code>git</code>. <code>git</code> è il vero motore alla
base di =git=hub, e in generale è un po' il vcs standard per lavorare
con molte persone a del codice.
</p>

<p>
<code>git</code> è quindi un VCS.
</p>

<p>
VCS = version control systems. Ce ne sono molti e sono dei sistemi
per tenere traccia di cambiamenti all'interno di una collezione di
file (una cartella in genere): come indica il nome questi strumenti
modellano la <i>storia</i> delle modifiche, facilitando la collaborazione
tra persone diverse che vogliono accedere e modificare i
file.
</p>

<p>
<code>Git</code> negli anni, è diventato lo standard de facto per la
collaborazione, forte del modello che propone e delle funzionalità
che questo abilita, che facilitano di molto la vita di chi scrive
software.
</p>

<p>
L'idea alla base di <code>git</code> è quella di fare una specie di <i>foto</i>
della cartella (lo chiamerò snapshot dall'inglese, o <i>commit</i> che è
la terminologia di <code>git</code>) e salvarla, mettendola in relazione con i
commit precedentemente fatti. Per fare questo salva anche una serie
di meta-dati, come <i>chi</i> ha creato il commit, un <i>messaggio</i>. che
spieghi in breve le modifiche apportate e una serie di cose
facoltative come firme digitali e così via.
</p>

<p>
Questo per dire <i>chi</i> ha fatto <i>cosa</i> e <i>quando</i>
</p>

<p>
Oltre a questo permette di lavorare in parallelo con altre persone e
preoccuparsi di mettere insieme i cambiamenti fatti solo quando è
necessario, eventualmente occupandosi dei singoli punti in cui
vengono fatte modifiche assieme.
</p>
</div>
</div>

<div id="outline-container-orgda9ca51" class="outline-2">
<h2 id="orgda9ca51"><span class="section-number-2">2.</span> Modello</h2>
<div class="outline-text-2" id="text-2">
<p>
Per spiegare come funziona <code>git</code>, anziché far vedere direttamente
l'interfaccia, quindi i comandi che offre, che a mio avviso sono un
po' confusionari, vedremo partendo dal basso il modello che <code>git</code>
utilizza per modellare la storia, ne chiariremo un attimo la
terminologia e alla fine vedremo dei comandi e come questi agiscono
sul modello sottostante. La motivazione è che in questo modo sarà
più facile quando si hanno degli errori capirli e risolverli (o
capire che soluzione cercare e se la soluzione che troviamo ha
senso).
</p>
</div>

<div id="outline-container-orgf2109f1" class="outline-3">
<h3 id="orgf2109f1"><span class="section-number-3">2.1.</span> Cartelle e file (tree and blob)</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">
<pre class="src src-text">&lt;root&gt; (tree)
|
+- foo (tree)
|  |
|  + bar.txt (blob, contents = "hello world")
|
+- baz.txt (blob, contents = "=git= is wonderful")
</pre>
</div>
<p>
Il contenuto di una cartella è visto così da <code>git</code>, e quando lo
salva ne fa una foto (<code>commit</code>). Al momento del salvataggio
aggiunge anche una serie di informazioni aggiuntive come <i>chi</i> lo
ha creato e un breve <i>messaggio</i> che ne descriva i cambiamenti
principali apportati all'intera cartella.
</p>

<p>
Un <code>commit</code> contiene quindi:
</p>
<ul class="org-ul">
<li>Una lista di genitori (altri commit, o nessuno se è il primo)</li>
<li>I meta-dati (autore, data, messaggio, &#x2026;)</li>
<li>lo <code>snapshot</code> (il contenuto della cartella in quel momento)</li>
</ul>


<p>
Per metterli in relazione può semplicemente metterli in sequenza
uno dopo l'altro&#x2026; ma <code>git</code> ha un modello un po' più raffinato:
modella la storia come un grafo diretto aciclico. Fancy math word
per dire che ogni commit mantiene una lista <i>dei genitori</i> (che
possono essere svariati!) e ogni commit può essere genitore di
molti figli.
</p>

<p>
Esempio: Il caso più semplice è quello di me e un mio amico che
stiamo lavorando a qualcosa assieme, io aggiungo una feature al
nostro programma e lui corregge un bug. Vogliamo farlo però in
parallelo, senza aspettare che uno finisca il lavoro prima che
l'altro inizi. In questo caso la storia che andiamo a modellare
avrà una forma come
</p>

<div class="org-src-container">
<pre class="src src-text">o &lt;-- o &lt;-- o &lt;-- o
	    ^
	     \
	      --- o &lt;-- o
</pre>
</div>

<p>
e quando poi vogliamo mettere assieme i risultati
</p>

<div class="org-src-container">
<pre class="src src-text">o &lt;-- o &lt;-- o &lt;-- o &lt;---- o
	    ^            /
	     \          v
	      --- o &lt;-- o
</pre>
</div>

<p>
Ci ritroviamo sia con le feature aggiuntive che con il bug risolto
in metà del tempo.
</p>

<p>
Una domanda che potrebbe sorgere spontanea è: posso modificare un
commit già fatto? mi sono dimenticato di includere un file in
precedenza e ho già fatto il commit, posso eliminarlo e rifare?
Risposta breve: No, i commit sono immutabili. Risposta lunga: Si,
ma quello che si vuole fare non è quindi rimodellare la storia,
bensì aggiungere un file, e questo è consentito facendo un nuovo
commit che includa quel file.
</p>
</div>
</div>

<div id="outline-container-orgae4d1b0" class="outline-3">
<h3 id="orgae4d1b0"><span class="section-number-3">2.2.</span> Dare dei nomi</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Una cosa che facciamo con la storia è indicare le date, ovvero dei
punti al suo interno.
</p>

<p>
Allo stesso modo <code>git</code> da un nome ad ogni <i>oggetto</i> del quale tiene
traccia.
</p>

<p>
<code>git</code> tiene traccia tra i suoi <code>objects</code> di tre cose:
</p>
<dl class="org-dl">
<dt><code>blob</code> (s)</dt><dd>con una firma del suo contenuto</dd>
<dt><code>tree</code> (s)</dt><dd>con una firma dei file e cartelle al suo interno
(ricorsivamente)</dd>
<dt><code>commit</code> (s)</dt><dd>con la firma della cartella principale al momento
della creazione del commit (più i meta-dati associati)</dd>
</dl>


<p>
Cosa è la firma? La firma è una specie di riassunto di un file
molto più grande, <code>git</code> per chi vuole approfondire usa la funzione
<code>sha1</code> per nominare ogni cosa della quale tiene traccia.
</p>

<p>
<b>In questo modo ogni cosa (anche i commit) ha un nome</b>
</p>

<div class="org-src-container">
<pre class="src src-text">o &lt;-- o &lt;-- o &lt;-- o &lt;---- o &lt;~(7fa4cb3...09fe)
	    ^            /
	     \          v
	      --- o &lt;-- o
</pre>
</div>
</div>
</div>

<div id="outline-container-orga31c090" class="outline-3">
<h3 id="orga31c090"><span class="section-number-3">2.3.</span> Dare dei nomi migliori</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Una cosa che facciamo anche con la storia vera è nominare dei punti
con nomi più usabili: per esempio quando parlo della rivoluzione
francese sappiamo tutti (almeno a grosso modo) in che punto della
storia mi trovo, è raro che qualcuno ne parli indicando esattamente
le date di inizio e fine.  <code>Git</code> mantiene quindi oltre a questo
insieme di oggetti anche un insieme di <i>references</i>. Le
<i>references</i> altro non sono che dei nomi umani che diamo a questi
punti nel tempo (rivoluzione francese \(\rightarrow\) 1789 &#x2013; 1799).
</p>

<p>
In git una mappa che ha più senso è
</p>

<div class="org-src-container">
<pre class="src src-text">876fa87e6c...98c7a &lt;- main
</pre>
</div>

<p>
Notare che è il nome che viene mappato alla firma, non vice versa!
</p>
</div>
</div>
</div>

<div id="outline-container-org7f1613b" class="outline-2">
<h2 id="org7f1613b"><span class="section-number-2">3.</span> Demo</h2>
<div class="outline-text-2" id="text-3">
<p>
Vedremo ora alcuni comandi base di git e come questi influiscano sul
modello alla base. Parleremo alla fine anche di Github in maniera
astratta e di come si relaziona la sua terminologia al modello di
git.
</p>

<p>
(tutti i comandi di seguito funzionano di default sui terminali
linux e mac, su windows funzionano dall'interfaccia <code>bash for git</code>
che viene installata quando si installa <code>git</code>).
</p>

<p>
Muoviamoci in una cartella vuota, da qui faremo tutto
</p>

<div class="org-src-container">
<pre class="src src-sh">mkdir ~/git_demo;
cd ~/git_demo
</pre>
</div>
</div>

<div id="outline-container-org8af8079" class="outline-3">
<h3 id="org8af8079"><span class="section-number-3">3.1.</span> init</h3>
<div class="outline-text-3" id="text-3-1">
<p>
In primis vogliamo avere la nostra cartella su cui lavorare:
inizializziamola:
</p>

<div class="org-src-container">
<pre class="src src-sh">git init
</pre>
</div>

<pre class="example">
Initialized empty Git repository in /home/luca/git_demo/.git/
</pre>


<p>
Inizializza la cartella corrente come <i>repository</i>
git. <i>Repository</i> lo troviamo anche nella terminologia di github,
questo perché in inglese è sostanzialmente traducibile come <i>posto</i>
e quindi ha poco significato. Qui intendiamo la nostra cartella che
vogliamo tracciare, github intende la cartella remota.
</p>
</div>
</div>

<div id="outline-container-org817bac3" class="outline-3">
<h3 id="org817bac3"><span class="section-number-3">3.2.</span> status</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Una cosa molto comune è vedere <i>come è messa</i> la nostra cartella,
come si relaziona alla nostra storia.
</p>

<div class="org-src-container">
<pre class="src src-sh">git status
</pre>
</div>

<pre class="example">
On branch main

No commits yet

nothing to commit (create/copy files and use "git add" to track)
</pre>


<p>
Ci dirà:
</p>
<ul class="org-ul">
<li>il <i>ramo</i> sul quale siamo (reference del commit attuale se ce n'è
uno)</li>
<li>se il lavoro nella cartella è aggiornato con la storia o ci sono
delle modifiche</li>
</ul>
</div>
</div>

<div id="outline-container-org014697e" class="outline-3">
<h3 id="org014697e"><span class="section-number-3">3.3.</span> aggiungere qualcosa</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Vogliamo ora aggiungere dei file alla nostra cartella e fare un
<code>commit</code>. Per esempio creiamo un file <code>hello.txt</code>
</p>

<div class="org-src-container">
<pre class="src src-sh">echo "hello world!" &gt; hello.txt
</pre>
</div>

<p>
se facciamo di nuovo
</p>

<div class="org-src-container">
<pre class="src src-sh">git status
</pre>
</div>

<pre class="example">
On branch main

No commits yet

Untracked files:
..." to include in what will be committed)
	hello.txt

nothing added to commit but untracked files present (use "git add" to track)
</pre>


<p>
Vediamo che il nostro file è segnato in rosso. Questo perché il
file è segnato come non presente o modificato nel tree e non è
stato aggiunto all'aria di <i>stage</i>. Lo stage è un concetto chiave
per fare un nuovo <code>commit</code> e l'idea è quella che nel prossimo
commit magari non voglio inserire tutti i file ai quali sto
lavorando.
</p>

<p>
Aggiungiamo quindi il nostro file all'area di stage
</p>

<div class="org-src-container">
<pre class="src src-sh">git add hello.txt
</pre>
</div>

<p>
E ora l'output di <code>git status</code> ci mostrerà il file in verde. Per
fare un commit e registrare lo state corrente della storia facciamo
</p>

<div class="org-src-container">
<pre class="src src-sh">git commit -m "added hello.txt"
</pre>
</div>

<pre class="example">
[main (root-commit) 8b6d7b6] added hello.txt
 1 file changed, 1 insertion(+)
 create mode 100644 hello.txt
</pre>


<p>
Il commit è creato, <code>git status</code> ancora indica che è tutto a posto
(nessuna col commit <i>che stiamo guardando</i>).
</p>

<p>
N.B. l'opzione <code>-m</code> nel comando di commit aggiunge un messaggio. Se
non lo indichiamo direttamente nel commit <code>git</code> aprirà per noi un
editor di testo, nel quale scrivere un messaggio che diventerà poi
il messaggio nei meta-dati del <code>commit</code>.
</p>

<p>
N.B.B. Il nuovo commit è stato creato a partire da quello al quale
il riferimento <code>HEAD</code> stava puntando!
</p>
</div>
</div>

<div id="outline-container-org8fe4720" class="outline-3">
<h3 id="org8fe4720"><span class="section-number-3">3.4.</span> Modificare e fare nuovo commit</h3>
<div class="outline-text-3" id="text-3-4">
<p>
Eseguire i passaggi di prima, ora però invece che creare da 0 il
file <code>hello.txt</code> modificarlo (con editor di testo o terminale va
bene uguale).
</p>
</div>
</div>

<div id="outline-container-org9fd03ff" class="outline-3">
<h3 id="org9fd03ff"><span class="section-number-3">3.5.</span> Visualizzare la storia</h3>
<div class="outline-text-3" id="text-3-5">
<p>
Ok, abbiamo quindi i nostri commit&#x2026; come facciamo a vedere cosa
sta succedendo nella nostra storia?
</p>

<div class="org-src-container">
<pre class="src src-sh">git log
</pre>
</div>

<pre class="example">
commit 8b6d7b6088c542b5ecbbeff637c0b9850c14c6d3 (HEAD -&gt; main)
Author: Luca Zaninotto (badadumTss) &lt;lucazanny@gmail.com&gt;
Date:   Wed Dec 7 17:09:36 2022 +0100

    added hello.txt
</pre>


<p>
ci fa vedere una versione appiattita della storia, con qualche flag
in più
</p>

<div class="org-src-container">
<pre class="src src-sh">git log --all --graph --decorate
</pre>
</div>

<pre class="example">
* commit 8b6d7b6088c542b5ecbbeff637c0b9850c14c6d3 (HEAD -&gt; main)
  Author: Luca Zaninotto (badadumTss) &lt;lucazanny@gmail.com&gt;
  Date:   Wed Dec 7 17:09:36 2022 +0100
  
      added hello.txt
</pre>


<p>
Ci mostrerà la struttura completa
</p>
</div>
</div>

<div id="outline-container-org57c8328" class="outline-3">
<h3 id="org57c8328"><span class="section-number-3">3.6.</span> Nomi di default</h3>
<div class="outline-text-3" id="text-3-6">
<p>
Notiamo dall'ultimo comando (<code>git log --all --graph --decorate</code>)
che ci sono delle informazioni aggiuntive sull'ultimo commit:
</p>

<ul class="org-ul">
<li><code>HEAD</code> è un riferimento speciale, che ci indica che quello è il
<code>commit</code> che <i>stiamo guardando</i>.</li>
<li><code>main</code> è il nome del <i>ramo</i> nel quale ci troviamo, un ramo è un
riferimento che indica una sequenza lineare (o quasi) di commit
fino al commit iniziale</li>
</ul>
</div>
</div>

<div id="outline-container-org3d4f4a2" class="outline-3">
<h3 id="org3d4f4a2"><span class="section-number-3">3.7.</span> diff</h3>
<div class="outline-text-3" id="text-3-7">
<div class="org-src-container">
<pre class="src src-sh">git diff &lt;from&gt; &lt;to&gt; &lt;file&gt;
</pre>
</div>

<p>
Ci permette di vedere quali sono le <i>differenze</i> in un file tra due
momenti della storia: &lt;from&gt; e &lt;to&gt; sono due riferimenti temporali:
quindi o la firma di un commit oppure una reference
</p>
</div>
</div>

<div id="outline-container-org77ff08e" class="outline-3">
<h3 id="org77ff08e"><span class="section-number-3">3.8.</span> Lavorare in parallelo</h3>
<div class="outline-text-3" id="text-3-8">
<div class="org-src-container">
<pre class="src src-sh">git branch
</pre>
</div>

<pre class="example">
* main
</pre>


<p>
è il comando chiave per spostarsi tra i vari <i>rami</i> di lavoro
(<i>branches</i> in inglese), mentre invece
</p>

<div class="org-src-container">
<pre class="src src-sh">git checkout
</pre>
</div>

<p>
è il comando per visitare i singoli commit. Creiamo quindi un nuovo
<i>branch</i>
</p>

<div class="org-src-container">
<pre class="src src-sh">git branch feature
</pre>
</div>

<p>
Ora abbiamo creato il branch (riferimento ad update automatico), ma
non lo stiamo ancora <i>guardando</i>. possiamo farlo con
</p>

<div class="org-src-container">
<pre class="src src-sh">git checkout feature 	# -b for ~branch~
</pre>
</div>

<pre class="example">
Switched to branch 'feature'
</pre>


<p>
notiamo con <code>git log --all --decorate --graph</code> che la nostra <code>HEAD</code>
si è spostata dal riferimento <i>main</i> a <i>feature</i>.
</p>

<p>
Ora se aggiungiamo un commit verrà creato a partire dal nostro
riferimento <code>feature</code>.  Spostiamoci su <code>main</code> e proviamo a creare
li un nuovo commit.  Notiamo con <code>git log --all --decorate --graph</code>
che ora il nostro grafo ha un biforcazione.
</p>


<div class="org-src-container">
<pre class="src src-sh">echo "another line" &gt;&gt; hello.txt

git add hello.txt
git commit -m "updated hello.txt"
</pre>
</div>

<pre class="example">
[feature beffa95] updated hello.txt
 1 file changed, 1 insertion(+)
</pre>
</div>

<div id="outline-container-org65cd2fe" class="outline-4">
<h4 id="org65cd2fe"><span class="section-number-4">3.8.1.</span> Uniamo le modifiche</h4>
<div class="outline-text-4" id="text-3-8-1">
<p>
Innanzitutto spostiamoci sul branch <code>main</code>
</p>

<div class="org-src-container">
<pre class="src src-sh">git checkout main
</pre>
</div>

<pre class="example">
Switched to branch 'main'
</pre>


<p>
Siamo sul branch <code>main</code> e vogliamo integrare il cambiamento fatto
in <code>feature</code> qui dentro.
</p>

<p>
Iniziamo con
</p>

<div class="org-src-container">
<pre class="src src-sh">git merge feature
</pre>
</div>

<pre class="example">
Updating 8b6d7b6..beffa95
Fast-forward
 hello.txt | 1 +
 1 file changed, 1 insertion(+)
</pre>


<p>
Il comando darà il via ad un'operazione di merge, ovvero creazione
di un nuovo <code>commit</code> che ha come genitori il riferimento corrente
(visto che ho specificato solo un altro riferimento) e il branch
specificato (<code>feature</code>). Se va tutto bene il riferimento puntato
da <code>HEAD</code> sarà ora su un commit che contiene entrambe le
modifiche.
</p>

<div class="org-src-container">
<pre class="src src-sh">git log --oneline --graph --all --decorate
</pre>
</div>

<pre class="example">
* beffa95 (HEAD -&gt; main, feature) updated hello.txt
* 8b6d7b6 added hello.txt
</pre>
</div>
</div>

<div id="outline-container-orgb687dcc" class="outline-4">
<h4 id="orgb687dcc"><span class="section-number-4">3.8.2.</span> Risoluzione dei conflitti</h4>
<div class="outline-text-4" id="text-3-8-2">
<p>
E se non va tutto bene? Può essere che io e i miei collaboratori
abbiamo lavorato sullo stesso file per due modifiche
diverse&#x2026; che succede in questi casi?
</p>

<p>
<code>git</code> proverà ad unire le modifiche il più possibile (se abbiamo
lavorato su linee diverse dello stesso file può metterle assieme),
ma dove non sa come comportarsi chiede all'utente cosa fare:
</p>

<ul class="org-ul">
<li>unisce le modifiche (coerenti) nella cartella corrente</li>
<li>modifica i file dove ci sono dei conflitti in modo da mostrare
le modifiche in un branche le modifiche nell'altro, dando
all'utente la possibilità di scegliere cosa fare.</li>
</ul>


<p>
Una volta risolti i conflitti nel file nel quale ci sono conflitti
(modificandolo come un normale file di testo) è possibile finire
il merge (e creare quindi il nuovo commit con tutte le modifiche)
con
</p>

<div class="org-src-container">
<pre class="src src-sh">git merge --continue
</pre>
</div>

<p>
Vedremo che ci verrà chiesto un messaggio da allegare al nuovo
<code>commit</code>.
</p>
</div>
</div>
</div>

<div id="outline-container-orgb3075eb" class="outline-3">
<h3 id="orgb3075eb"><span class="section-number-3">3.9.</span> Remotes</h3>
<div class="outline-text-3" id="text-3-9">
<p>
Abbiamo parlato di molte cose, ma manca quella più importante di
tutte: come collaboro effettivamente con altre persone?
</p>

<p>
I remote sono la soluzione
</p>

<p>
Il meccanismo dei remote è quello col quale una cartella git è
<i>cosciente</i> dell'esistenza di altre copie di se ed è capace di
tenere traccia della storia condivisa.
</p>

<p>
GitHub è di fatto un servizio cloud per il mantenimento di <code>remote</code>
(s) accessibili a chi ne ha diritto.
</p>
</div>

<div id="outline-container-org33af985" class="outline-4">
<h4 id="org33af985"><span class="section-number-4">3.9.1.</span> Che remote abbiamo</h4>
<div class="outline-text-4" id="text-3-9-1">
<p>
Stampa una lista dei remote configurati
</p>
<div class="org-src-container">
<pre class="src src-sh">git remote
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc0e4601" class="outline-4">
<h4 id="orgc0e4601"><span class="section-number-4">3.9.2.</span> Aggiungiamo un remote</h4>
<div class="outline-text-4" id="text-3-9-2">
<div class="org-src-container">
<pre class="src src-sh">git remote add &lt;name&gt; &lt;url&gt;
</pre>
</div>
<p>
Aggiungiamo un remote all'url <code>&lt;url&gt;</code> e lo chiamiamo <code>&lt;name&gt;</code>
</p>
</div>
</div>

<div id="outline-container-org6c9029d" class="outline-4">
<h4 id="org6c9029d"><span class="section-number-4">3.9.3.</span> Aggiungiamo il nostro lavoro al remote</h4>
<div class="outline-text-4" id="text-3-9-3">
<div class="org-src-container">
<pre class="src src-sh">git push &lt;remote&gt; &lt;local branch&gt;:&lt;remote branch&gt;
</pre>
</div>
<p>
mettiamo i nostri cambiamenti fatti al branch <code>&lt;local branch&gt;</code> nel
branch <code>&lt;remote branch&gt;</code> del remote <code>&lt;remote&gt;</code>.
</p>
</div>
</div>

<div id="outline-container-orgdae168b" class="outline-4">
<h4 id="orgdae168b"><span class="section-number-4">3.9.4.</span> I nostri amici dall'altra parte</h4>
<div class="outline-text-4" id="text-3-9-4">
<p>
Prendono le modifiche che abbiamo fatto con
</p>
<div class="org-src-container">
<pre class="src src-sh">git pull			# macro per git fetch; git merge
</pre>
</div>
<p>
questa è in realtà una macro, ovvero due comandi concatenati e
chiamati in modo speciale, dato che è un'operazione estremamente
comune:
</p>
<dl class="org-dl">
<dt><code>git fetch</code></dt><dd>scarica semplicemente i cambiamenti, lascia i
riferimenti locali così come sono</dd>
<dt><code>git merge</code></dt><dd>tenta di fare un fast forward dal branch locale a
quello remoto, segnalando eventuali conflitti</dd>
</dl>
</div>
</div>


<div id="outline-container-org46c20c9" class="outline-4">
<h4 id="org46c20c9"><span class="section-number-4">3.9.5.</span> E se ho modificato qualcosa intanto?</h4>
<div class="outline-text-4" id="text-3-9-5">
<p>
È uno scenario abbastanza comune: lavoro con altre persone su del
codice, faccio i miei commit, <code>git pull</code> e mi viene fuori merge
conflict: anche gli altri hanno lavorato sugli stessi file, git ha
sistemato il sistemabile, tocca a te sistemare i file su cui non
è chiaro cosa fare, li puoi vedere con <code>git status</code>
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org2be27e4" class="outline-2">
<h2 id="org2be27e4"><span class="section-number-2">4.</span> Credits / risorse</h2>
<div class="outline-text-2" id="text-4">
<p>
Menzione unica al programma <a href="https://missing.csail.mit.edu/">Missing semester at MIT</a>, contenente
molte risorse interessanti per approfondire tutta la letteratura
informatica che viene data un po' per scontata dagli informatici
stessi. Questo stesso incontro è stato tratto da <a href="https://missing.csail.mit.edu/2020/version-control/">la loro lecture su
Git</a> (con più riferimenti, esercizi e risorse).
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Luca Zaninotto</p>
<p class="date">Created: 2022-12-07 Wed 18:49</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
